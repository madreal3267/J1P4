<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.itwillbs.mapper.ProjectMapper">
  	 <insert id="insertProj">
  	 	insert into project (ct_no,work_field,proj_title,proj_progress,start_date,date_nego,work_period,
  	 	no_recruited,deadline,proj_cost,cost_nego,pmeet_meth,meet_meth,meet_cycle,proj_content,job_level,
  	 	career_proof,wanted_career,dlvy_msg) 
  	 	values((select ct_no from client where ct_id = #{user_id}),#{work_field},#{proj_title},#{proj_progress},#{start_date},#{date_nego},#{work_period},
  	 	#{no_recruited},#{deadline},#{proj_cost},#{cost_nego},#{pmeet_meth},#{meet_meth},#{meet_cycle},#{proj_content},#{job_level},
  	 	#{career_proof},#{wanted_career},#{dlvy_msg})
  	 </insert>
  	 
  	 <insert id="saveProj">
  	 	insert into project (ct_no,work_field,proj_title,proj_progress,start_date,date_nego,work_period,
  	 	no_recruited,deadline,proj_cost,cost_nego,pmeet_meth,meet_meth,meet_cycle,proj_content,job_level,
  	 	career_proof,wanted_career,dlvy_msg,temporary) 
  	 	values((select ct_no from client where ct_id = #{user_id}),#{work_field},#{proj_title},#{proj_progress},#{start_date},#{date_nego},#{work_period},
  	 	#{no_recruited},#{deadline},#{proj_cost},#{cost_nego},#{pmeet_meth},#{meet_meth},#{meet_cycle},#{proj_content},#{job_level},
  	 	#{career_proof},#{wanted_career},#{dlvy_msg},"임시저장")
  	 </insert>
  	 
  	 <update id="updateProj">
  	   update project set work_field=#{work_field},proj_title=#{proj_title},proj_progress=#{proj_progress},start_date=#{start_date},date_nego=#{date_nego},work_period=#{work_period},
  	 	no_recruited=#{no_recruited},deadline=#{deadline},proj_cost=#{proj_cost},cost_nego=#{cost_nego},pmeet_meth=#{pmeet_meth},meet_meth=#{meet_meth},meet_cycle=#{meet_cycle},proj_content=#{proj_content},job_level=#{job_level},
  	 	career_proof=#{career_proof},wanted_career=#{wanted_career},dlvy_msg=#{dlvy_msg},temporary="등록완료" 
  	 	where proj_no=#{proj_no}
  	 </update>
  	 
  	 <update id="multiSaveProj">
  	 	update project set work_field=#{work_field},proj_title=#{proj_title},proj_progress=#{proj_progress},start_date=#{start_date},date_nego=#{date_nego},work_period=#{work_period},
  	 	no_recruited=#{no_recruited},deadline=#{deadline},proj_cost=#{proj_cost},cost_nego=#{cost_nego},pmeet_meth=#{pmeet_meth},meet_meth=#{meet_meth},meet_cycle=#{meet_cycle},proj_content=#{proj_content},job_level=#{job_level},
  	 	career_proof=#{career_proof},wanted_career=#{wanted_career},dlvy_msg=#{dlvy_msg}
  	 	where proj_no=(select c.proj_no from (select max(proj_no) as proj_no from project where ct_no = (select ct_no from client where ct_id = #{user_id})) c)
  	 </update>

	<insert id="insertSkill">
		insert into skill (proj_no,skill_nm,skill_lev) 
		values((select max(proj_no) from project),#{skill_nm},#{skill_lev})
	</insert>
	
	<insert id="insertReg">
		insert into region (proj_no,region,district)
		values((select max(proj_no) from project),#{region},#{district})
	</insert>
	
	<update id="multiSaveSk">
		update skill set skill_nm=#{skill_nm},skill_lev=#{skill_lev}
		where proj_no=(select c.proj_no from (select max(proj_no) as proj_no from project where ct_no = (select ct_no from client where ct_id = #{user_id})) c)
	</update>
	
	<update id="multiSaveReg">
		update region set region=#{region},district=#{district}
		where proj_no=(select c.proj_no from (select max(proj_no) as proj_no from project where ct_no = (select ct_no from client where ct_id = #{user_id})) c)
	</update>

  
  </mapper>