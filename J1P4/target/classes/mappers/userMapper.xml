<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.itwillbs.mapper.UserMapper">
  	 
<!--   	 <select id="getAllUsers" resultType="com.itwillbs.dto.UserDTO"> -->
<!--         SELECT  -->
<!--             f.free_no AS no,  -->
<!--             f.free_id AS id,  -->
<!--             u.name,  -->
<!--             u.user_type,  -->
<!--             u.reg_date, -->
<!--             'freelancer' AS role -->
<!--         FROM freelancer f -->
<!--         JOIN user u ON f.free_id = u.user_id -->
<!--         UNION ALL -->
<!--         SELECT  -->
<!--             c.ct_no AS no,  -->
<!--             c.ct_id AS id,  -->
<!--             u.name,  -->
<!--             u.user_type,  -->
<!--             u.reg_date, -->
<!--             'client' AS role -->
<!--         FROM client c -->
<!--         JOIN user u ON c.ct_id = u.user_id -->
<!--     </select> -->
	  <select id="getAllUsers" resultType="com.itwillbs.dto.UserDTO">
        SELECT * FROM (
            SELECT 
                f.free_no AS no, 
                f.free_id AS id, 
                u.name, 
                u.user_type, 
                u.reg_date,
                'freelancer' AS role
            FROM freelancer f
            JOIN user u ON f.free_id = u.user_id
            UNION ALL
            SELECT 
                c.ct_no AS no, 
                c.ct_id AS id, 
                u.name, 
                u.user_type, 
                u.reg_date,
                'client' AS role
            FROM client c
            JOIN user u ON c.ct_id = u.user_id
        ) AS all_users
        ORDER BY all_users.reg_date DESC
    </select>

    <select id="getFreelancers" resultType="com.itwillbs.dto.UserDTO">
        SELECT 
            f.free_no AS no, 
            f.free_id AS id, 
            u.name, 
            u.user_type, 
            u.reg_date,
            'freelancer' AS role
        FROM freelancer f
        JOIN user u ON f.free_id = u.user_id
        ORDER BY u.reg_date DESC
    </select>

    <select id="getClients" resultType="com.itwillbs.dto.UserDTO">
        SELECT 
            c.ct_no AS no, 
            c.ct_id AS id, 
            u.name, 
            u.user_type, 
            u.reg_date,
            'client' AS role
        FROM client c
        JOIN user u ON c.ct_id = u.user_id
        ORDER BY u.reg_date DESC
    </select>
  </mapper>